<!DOCTYPE html>
<html lang="vi" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Th·ªùi kh√≥a bi·ªÉu gi√°o vi√™n</title>
  <meta name="description" content="B·∫£ng th·ªùi kh√≥a bi·ªÉu cho gi√°o vi√™n: s√°ng 4 ti·∫øt, chi·ªÅu 3 ti·∫øt, c√≥ th·ªùi gian, ra ch∆°i v√† nh·∫≠p m√¥n h·ªçc." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600&family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg1: #f8fafc;
      --bg2: #e0f2fe;
      --bg3: #fde68a;
      --surface: #ffffff;
      --text: #0f172a;
      --muted: #64748b;
      --primary: #7c3aed;
      --primary2:#06b6d4;
      --accent: #22c55e;
      --border: #e2e8f0;
      --highlight: #fef08a;
      --break-grad1: #c7f9cc;
      --break-grad2: #80ed99;
      --lunch-bg: #ffe4e6;
    }
    body{
      margin:0; font-family:'Inter',system-ui,Segoe UI,Roboto,Arial; color:var(--text);
      background:
        radial-gradient(1200px 500px at -10% -10%, var(--bg2) 0%, transparent 60%),
        radial-gradient(900px 500px at 110% 0%, var(--bg3) 0%, transparent 55%),
        linear-gradient(180deg, #ffffff, var(--bg1));
      min-height:100vh;
      overflow-x:hidden;
    }
    header{
      padding:42px 20px 56px; color:#fff; position:relative; overflow:hidden;
      background:linear-gradient(100deg, var(--primary), var(--primary2));
      box-shadow:0 20px 60px #0000001a; border-bottom-left-radius:28px; border-bottom-right-radius:28px;
    }
    header:after{
      content:""; position:absolute; inset:-30%; background:conic-gradient(from 0deg at 50% 50%, #ffffff33, #ffffff00 20%, #ffffff33 40%, #ffffff00 60%, #ffffff33 80%, #ffffff00);
      animation:spin 12s linear infinite; pointer-events:none; mix-blend-mode:soft-light;
    }
    @keyframes spin{to{transform:rotate(1turn)}}
    .hdr{max-width:1100px; margin:0 auto; display:flex; align-items:center; justify-content:space-between; gap:16px}
    .brand{display:flex; gap:14px; align-items:center}
    .logo{
      width:56px; height:56px; border-radius:999px; overflow:hidden; display:flex; align-items:center; justify-content:center;
      background:#ffffff22; box-shadow:inset 0 0 0 2px #ffffff55
    }
    .logo img{width:100%; height:100%; object-fit:cover;}
    .title{margin:0; font:600 34px/1.1 Poppins, sans-serif; letter-spacing:-.02em}
    #today{opacity:.95; font-weight:600}
    .actions{display:flex; gap:10px}
    .btn{display:inline-flex; align-items:center; gap:8px; padding:10px 14px; border-radius:12px; border:1px solid #ffffff55; background:#ffffff1a; color:#fff; backdrop-filter:blur(6px); font-weight:700; cursor:pointer}
    .btn:hover{transform:translateY(-1px); box-shadow:0 8px 24px #00000026}
    .btn.primary{background:#ffffff; color:#0f172a}
    main{max-width:100%; margin:-32px auto 40px; padding:0 10px; overflow-x:auto}
    .card{border-radius:22px; background:#ffffffcc; backdrop-filter:blur(10px); border:1px solid var(--border); box-shadow:0 30px 60px #00000012; width:100%; margin:auto; overflow-x:auto}
    .card-header{display:flex; align-items:center; justify-content:space-between; padding:14px 18px; border-bottom:1px solid var(--border)}
    .legend{display:flex; gap:8px; flex-wrap:wrap}
    .chip{display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:999px; font-size:12px; background:#f8fafc; border:1px solid var(--border)}
    .table-wrap{border-radius:0 0 22px 22px; overflow-x:auto}
    table{width:100%; border-collapse:separate; border-spacing:0; background:transparent; table-layout:fixed}
    thead th{position:sticky; top:0; background:#f1f5ff; font-family:Poppins, sans-serif; font-weight:700}
    th,td{padding:14px 12px; border-bottom:1px solid var(--border); border-right:1px solid var(--border); text-align:center; word-wrap:break-word}
    th:first-child, td:first-child{background:#f8fafc; font-weight:700; z-index:1}
    th:last-child, td:last-child{border-right:none}
    tr:last-child td{border-bottom:none}
    td[contenteditable="true"]{background:#ffffff; border-radius:10px}
    td[contenteditable="true"]:focus{outline:2px solid var(--primary)}
    .break-row td{background:linear-gradient(90deg, var(--break-grad1), var(--break-grad2))!important; font-style:italic; font-weight:700; color:#065f46; border-left:6px solid #22c55e33}
    .lunch-row td{background:var(--lunch-bg)!important; font-style:italic; font-weight:700; color:#9f1239}
    .highlight{background:var(--highlight)!important; font-weight:800; box-shadow:0 0 0 3px #f59e0b88 inset, 0 0 0 8px #f59e0b22; border-radius:12px; position:relative}
    .highlight:after{content:"ƒêANG H·ªåC"; position:absolute; top:6px; right:6px; font-size:10px; font-weight:900; background:#22c55e; color:#fff; padding:2px 6px; border-radius:999px; letter-spacing:.04em; opacity:.9}
    footer{padding:22px; text-align:center; color:var(--muted)}

    /* Hi·ªáu ·ª©ng ch√πm nho r∆°i */
    .grape-cluster{
      position:fixed; top:-100px; display:flex; flex-wrap:wrap;
      width:54px; height:72px; justify-content:center;
      animation:fall 18s linear infinite; z-index:9999;
    }
    .grape-cluster .berry{
      width:14px; height:14px; margin:1px;
      background:radial-gradient(circle at 30% 30%, #a855f7, #6b21a8);
      border-radius:50%;
      box-shadow:inset -2px -2px 4px rgba(0,0,0,.25);
    }
    .grape-cluster::before{
      content:''; position:absolute; top:-16px; left:50%;
      width:10px; height:18px; background:#15803d;
      border-radius:4px; transform:translateX(-50%);
    }
    @keyframes fall{
      0%{ transform:translateY(-120px) rotate(0); opacity:1 }
      100%{ transform:translateY(110vh) rotate(360deg); opacity:0 }
    }

    @media (max-width: 768px) {
      table {font-size: 12px}
      th, td {padding: 10px 6px}
      .title {font-size: 22px}
    }
  </style>
</head>
<body>
  <header>
    <div class="hdr">
      <div class="brand">
        <div class="logo"><img src="avatar-chibi.png" alt="Avatar gi√°o vi√™n" onerror="this.outerHTML='GV'"/></div>
        <div>
          <h1 class="title">Th·ªùi kh√≥a bi·ªÉu Gi√°o vi√™n</h1>
          <div id="today"></div>
        </div>
      </div>
      <div class="actions">
        <button class="btn" id="saveBtn">üíæ L∆∞u</button>
        <button class="btn" id="printBtn">üñ®Ô∏è In</button>
        <button class="btn primary" id="themeBtn">üåó Giao di·ªán</button>
      </div>
    </div>
  </header>

  <main>
    <section class="card">
      <div class="card-header">
        <div class="legend">
          <span class="chip">‚è∞ Gi·ªù h·ªçc 35‚Ä≤</span>
          <span class="chip">üõéÔ∏è Ra ch∆°i 15‚Ä≤ (s√°ng 8:45, chi·ªÅu 15:00)</span>
          <span class="chip">üí° Nh·∫•p √¥ ƒë·ªÉ nh·∫≠p m√¥n</span>
        </div>
      </div>
      <div class="table-wrap">
        <table id="table">
          <thead>
            <tr>
              <th>Ca</th>
              <th>Ti·∫øt</th>
              <th>Gi·ªù</th>
              <th>Th·ª© 2</th>
              <th>Th·ª© 3</th>
              <th>Th·ª© 4</th>
              <th>Th·ª© 5</th>
              <th>Th·ª© 6</th>
            </tr>
          </thead>
          <tbody id="tbody"></tbody>
        </table>
      </div>
    </section>
  </main>

  <footer>¬© <span id="year"></span> Th·ªùi kh√≥a bi·ªÉu gi√°o vi√™n</footer>

  <script>
    const tbody = document.getElementById('tbody');
    const STORAGE_KEY = 'tkb-teacher-v6';

    const caTiet = [
      { ca:'S√°ng', tiet:1, gio:'07:30 - 08:05' },
      { ca:'S√°ng', tiet:2, gio:'08:10 - 08:45' },
      { break:true, ca:'S√°ng', gio:'08:45 - 09:00', label:'Ra ch∆°i' },
      { ca:'S√°ng', tiet:3, gio:'09:15 - 09:50' },
      { ca:'S√°ng', tiet:4, gio:'09:55 - 10:30' },
      { lunch:true, gio:'10:30 - 13:30', label:'Ngh·ªâ tr∆∞a' },
      { ca:'Chi·ªÅu', tiet:1, gio:'13:30 - 14:05' },
      { ca:'Chi·ªÅu', tiet:2, gio:'14:10 - 14:45' },
      { break:true, ca:'Chi·ªÅu', gio:'14:45 - 15:00', label:'Ra ch∆°i' },
      { ca:'Chi·ªÅu', tiet:3, gio:'15:25 - 16:00' }
    ];

    const DATA = {
      1: { 'S√°ng-1': 'Ch√†o c·ªù', 'S√°ng-2': '2/3', 'S√°ng-3': '3/3', 'S√°ng-4': '3/1' },
      2: { 'S√°ng-4': '1/3', 'Chi·ªÅu-1': '2/2', 'Chi·ªÅu-3': '1/1' },
      4: { 'Chi·ªÅu-1': '1/4', 'Chi·ªÅu-2': '3/4', 'Chi·ªÅu-3': '3/4' },
      5: { 'S√°ng-1': '3/2', 'S√°ng-2': '2/1', 'S√°ng-3': '1/2' }
    };

    function buildTable(){
      tbody.innerHTML='';
      caTiet.forEach(row=>{
        const tr=document.createElement('tr');
        if(row.break){
          tr.classList.add('break-row');
          tr.innerHTML=`<td>${row.ca}</td><td colspan="2">${row.label}<br><small>${row.gio}</small></td>${'<td></td>'.repeat(5)}`;
        } else if(row.lunch){
          tr.classList.add('lunch-row');
          tr.innerHTML=`<td colspan="3">${row.label}<br><small>${row.gio}</small></td>${'<td></td>'.repeat(5)}`;
        } else {
          let cols = '';
          for(let d=1; d<=5; d++){
            let key = `${row.ca}-${row.tiet}`;
            let val = DATA[d]?.[key] || '';
            cols += `<td contenteditable="true">${val}</td>`;
          }
          tr.innerHTML=`<td>${row.ca}</td><td>${row.tiet}</td><td>${row.gio}</td>${cols}`;
        }
        tbody.appendChild(tr);
      });
    }

    function highlightTick(){
      const now=new Date();
      const day=now.getDay();
      const minutes = now.getHours()*60 + now.getMinutes();

      [...tbody.querySelectorAll('.highlight')].forEach(el=>el.classList.remove('highlight'));

      if(day>=1 && day<=5){
        const colIndex = day + 2;
        caTiet.forEach((row,i)=>{
          if(!row.break && !row.lunch){
            const [s,e] = row.gio.split(' - ');
            const toMin=t=>{const [hh,mm]=t.split(':').map(Number);return hh*60+mm};
            const S=toMin(s), E=toMin(e);
            if(minutes>=S && minutes<=E){
              tbody.rows[i].cells[colIndex].classList.add('highlight');
            }
          }
        });
      }
      document.getElementById('today').textContent = new Date().toLocaleDateString('vi-VN',{weekday:'long', day:'2-digit', month:'2-digit', year:'numeric'});
    }

    function save(){
      const data=[...tbody.rows].map(r=>[...r.cells].map(c=>c.getAttribute('contenteditable')?c.innerHTML:c.innerText));
      localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
    }

    function load(){
      const raw=localStorage.getItem(STORAGE_KEY); if(!raw) return; let data; try{data=JSON.parse(raw)}catch{return}
      [...tbody.rows].forEach((r,i)=>{ [...r.cells].forEach((c,j)=>{ if(c.getAttribute('contenteditable')){ c.innerHTML=(data?.[i]?.[j]||c.innerHTML); } }); });
    }

    buildTable();
    load();
    highlightTick();
    setInterval(highlightTick, 30000);

    tbody.addEventListener('input', e=>{ if(e.target.matches('[contenteditable]')){ save(); } });
    document.getElementById('printBtn').addEventListener('click', ()=>window.print());
    document.getElementById('saveBtn').addEventListener('click', save);
    document.getElementById('themeBtn').addEventListener('click', ()=>{
      const root = document.documentElement; const on = root.dataset.theme||'light';
      root.dataset.theme = on==='light' ? 'dark' : 'light';
    });

    document.getElementById('year').textContent=new Date().getFullYear();

    // Hi·ªáu ·ª©ng ch√πm nho r∆°i (5 c·ª•m, r∆°i ch·∫≠m)
    for(let i=0;i<5;i++){
      const cluster=document.createElement('div');
      cluster.className='grape-cluster';
      cluster.style.left = Math.random()*100 + 'vw';
      cluster.style.animationDuration = (16 + Math.random()*8) + 's';

      const berryCount = 7 + Math.floor(Math.random()*3);
      for(let b=0;b<berryCount;b++){
        const berry = document.createElement('div');
        berry.className = 'berry';
        cluster.appendChild(berry);
      }
      document.body.appendChild(cluster);
    }
  </script>
</body>
</html>
